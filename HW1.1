#include <stdio.h>
#include <unistd.h>
#include <sys/wait.h>

int main(){
    pid_t pid;
    int im;
    
    im = getpid();
    printf("i am %d ",im);
    
    pid = fork();   //f0
    
    if(pid > 0) printf("i f0 to %d\n",pid);
    
    if(pid == 0){
        
        im = getpid();
        printf("i am %d ",im);
        pid = fork();  //f1
        if(pid > 0) printf("i f1 to %d\n",pid);
        if(pid > 0)
            wait(NULL);
        im = getpid();
        printf("i am %d ",im);
        pid = fork();  //f2
        if(pid > 0) printf("i f2 to %d\n",pid);
        if(pid > 0)
            wait(NULL);
    }
    else if(pid > 0){
        wait(NULL);
        im = getpid();
        printf("i am %d ",im);
        pid = fork();  //f3
        if(pid > 0) printf("i f3 to %d\n",pid);
        if(pid > 0)
            wait(NULL);
    }
    else{
        printf("Error!");
    }
    im = getpid();
    printf("i am %d ",im);
    pid = fork();  //f4
    if(pid > 0) printf("i f4 to %d\n",pid);
    if(pid > 0)
        wait(NULL);
    /*
    int now = getpid();
    int p = getppid();
    printf("im");
    printf("%d",now);
    printf("   my parent is");
    printf("%d",p);
    */
    printf("  end\n");
    
    return 0;
}
